<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
    
{% load static %}
<link rel="stylesheet" href={% static 'style.css' %} type="text/css">

{% load template_filters %}

{% block head %}
    <title>Alternatives comparison</title>
{% endblock head %}

{% block body %}
    <div class="container">
        <h1>Сравнение альтернатив</h1>
        
        {% if show %}
            {% for criterion in criterions %}
                <br><h3>Сравнение по критерию {{ criterion.cname }}</h3><br>
                {{ df_dict| get_item:criterion.id| safe }}
                <br>
            {% endfor %}
            <form method="post">
                {% csrf_token %}
                <button type="submit" class="btn btn-primary" name="check">Проверить на корректность</button>
            </form>
            
        {% elif check %}
            {% for criterion in criterions %}
                <br><h3>Сравнение по критерию {{ criterion.cname }}</h3><br>
                {{ df_consistency_dict|get_item:criterion.id|safe }}
                <br>
                {% if consistency_marks|get_item:criterion.id %}
                    <p>OK</p>
                {% else %}
                    <p>Нихера не ок</p>
                {% endif %}
                {{ consistency_marks| get_item:criterion.id| safe }}
                <br>
            {% endfor %}
            <br>
            <form method="post">
                {% csrf_token %}
                <button type="submit" class="btn btn-primary" name="next">Далее</button>
            </form>
            
        {% else %}
            <form method="post">
                {% csrf_token %}
                {% for criterion in criterions %}
                    <br><h3>Сравнение по критерию {{ criterion.cname }}</h3><br>
                    <table>
                        <tr>
                            <th>Альтернативы</th>
                            {% for a in alternatives %}
                                <th>{{ a.aname }}</th>
                            {% endfor %}
                        </tr>
                        {% for ar in alternatives %}
                            <tr>
                                <td>{{ ar.aname }}</td>
                                {% for ad in alternatives %}
                                    {% if forloop.counter == forloop.parentloop.counter %}
                                        <td>1</td> 
                                    {% elif forloop.counter > forloop.parentloop.counter %}
                                        <td><input type="text" class="table-input" name="{{ criterion.id }}_{{ ar.id }}_{{ad.id}}"/></td>
                                    {% else %}
                                        <td>-</td> 
                                    {% endif %}
                                {% endfor %}
                            </tr>
                        {% endfor %}
                    </table>
                {% endfor %} 
                <button type="submit" class="btn btn-primary" name="show">Рассчитать</button>
            </form>
        {% endif %}   
    </div>
    {% endblock body %}